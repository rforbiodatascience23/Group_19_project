# Liver disease and comordities relations 

```{r}
stacked_bar_liverDisease <- dat_aug_03 |>
  select(Liver_disease, Comorbidities) |> 
  count(Liver_disease, Comorbidities)|>
  rename(d_c_count = n) |> 
  arrange(Liver_disease, desc(d_c_count)) |>
  mutate(Comorbidities = fct_inorder(Comorbidities))
```

```{r}
stacked_bar_liverDisease 
```


```{r}

ggplot(dat_aug_03, 
       aes(x = Liver_disease,
           fill = Comorbidities)) +
  geom_bar() +
  scale_fill_viridis(discrete = TRUE, option = "D") +
  labs(title = "Hospitalizations by Liver Disease and Comorbidities",
       x = "Liver Disease",
       y = "Hospitalizations") +
  theme_minimal() +
  theme(legend.position = "right",
        legend.key.height= unit(0.4, 'cm'),
        legend.key.width= unit(0.2, 'cm')) +
  coord_flip()
```

```{r}
test2 <- stacked_bar_liverDisease |>
  filter(d_c_count<87)
```


```{r}
ggplot(stacked_bar_liverDisease, 
       aes(Liver_disease, Comorbidities)) +
  geom_tile(aes(fill= d_c_count))+
  labs(fill = "Count" ,
       title = "Hospitalizations by Liver Disease and Comorbidities",
       x = "Liver Disease",
       y = "Comorbidities") +
  scale_fill_viridis() +
  theme_classic()+ 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
```

