```{r}
nAnalysis4 <- dat_aug_03
```
```{r}

```


```{r}
nAnalysis4
```
```{r}
stacked_bar_liverDisease <- nAnalysis4 |>
  select(Liver_disease, Comorbidities)
```

```{r}
nAnalysis4|>
  group_by(Comorbidities)|>
  count()
```

```{r}
stacked_bar_liverDisease <- stacked_bar_liverDisease |>
  count(Liver_disease, Comorbidities)|>
  rename(d_c_count = n)
```

```{r}
library(viridis)
```

```{r}
stacked_bar_liverDisease|>
  view()
```

```{r}
stacked_bar_liverDisease <-stacked_bar_liverDisease |>
  arrange(Liver_disease,d_c_count)
```

```{r}
stacked_bar_liverDisease <- stacked_bar_liverDisease |>
  arrange(Liver_disease, desc(d_c_count)) |>
  mutate(Comorbidities = fct_inorder(Comorbidities))
```

```{r}
stacked_bar_liverDisease|>
  view()
```


```{r}
ggplot(stacked_bar_liverDisease, aes(x = Liver_disease,
                 y = d_c_count,
                 fill = Comorbidities)) +
  geom_bar(position="stack",
           stat="identity") +
  scale_fill_viridis(discrete = T) +
  labs(title = "Hospitalizations by Liver Disease and Comorbidities",
       x = "Liver Disease",
       y = "Hospitalizations") +
  theme_minimal() +
  theme(legend.position = "right",
        legend.key.height= unit(0.4, 'cm'),
        legend.key.width= unit(0.2, 'cm')) +
  coord_flip()
```
```{r}
test2 <- stacked_bar_liverDisease |>
  filter(d_c_count<87)
```


```{r}
ggplot(test2, aes(Liver_disease, Comorbidities)) +
  geom_tile(aes(fill= d_c_count))+
  scale_fill_viridis() +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
```

