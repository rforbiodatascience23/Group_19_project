<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>08_analysis_liver_disease</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="08_analysis_liver_disease_files/libs/clipboard/clipboard.min.js"></script>
<script src="08_analysis_liver_disease_files/libs/quarto-html/quarto.js"></script>
<script src="08_analysis_liver_disease_files/libs/quarto-html/popper.min.js"></script>
<script src="08_analysis_liver_disease_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="08_analysis_liver_disease_files/libs/quarto-html/anchor.min.js"></script>
<link href="08_analysis_liver_disease_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="08_analysis_liver_disease_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="08_analysis_liver_disease_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="08_analysis_liver_disease_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="08_analysis_liver_disease_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">08_analysis_liver_disease</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"viridis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dat_aug_03 <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"~/projects/Group_19_project/data/03_dat_aug.tsv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1065 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (6): Sex, Age, Liver_disease, Comorbidities, Etiologies, Mortality
dbl (3): Id, CPS, Charlson_CI

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="impact-of-different-liver-diseases-on-mortality" class="level1">
<h1>Impact of different liver diseases on mortality</h1>
<section id="data-widening" class="level3">
<h3 class="anchored" data-anchor-id="data-widening">Data widening</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> dat_aug_03 <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Mortality (1 = y/0 = n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(Mortality <span class="sc">==</span> <span class="st">"No death"</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Liver_disease,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Liver_disease</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">19</span>, <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,065 × 19
      Id Sex    Age         CPS Charlson_CI Comorbidities   Etiologies Mortality
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;    
 1     1 Female [90; 100]     9           0 None            Cryptogen… No death 
 2     2 Male   [60; 70]      9           3 Moderate_sever… Alcohol_c… No death 
 3     2 Male   [60; 70]      9           3 Moderate_sever… Hepatitis… No death 
 4     3 Female [80; 90]      6           2 Mild_liver_dis… Non_alcoo… No death 
 5     3 Female [80; 90]      6           2 Diabetes_with_… Non_alcoo… No death 
 6     4 Female [70; 80]      8           9 Myocardial_inf… Cryptogen… No death 
 7     4 Female [70; 80]      8           9 Congestive_Hea… Cryptogen… No death 
 8     4 Female [70; 80]      8           9 Renal_disease   Cryptogen… No death 
 9     4 Female [70; 80]      8           9 Moderate_sever… Cryptogen… No death 
10     4 Female [70; 80]      8           9 Diabetes_with_… Cryptogen… No death 
# ℹ 1,055 more rows
# ℹ 11 more variables: `Mortality (1 = y/0 = n)` &lt;dbl&gt;,
#   `Hepatic encephalopathy` &lt;dbl&gt;, SBP &lt;dbl&gt;, Ascites &lt;dbl&gt;,
#   `Other fluid overload` &lt;dbl&gt;, AKI &lt;dbl&gt;,
#   `UGIB due to portal hypertension` &lt;dbl&gt;, `HCC or cholangioca.` &lt;dbl&gt;,
#   `Alcoholic hepatitis` &lt;dbl&gt;, `Jaundice- as isolated presentation` &lt;dbl&gt;,
#   `Hepato-hydrothorax` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="creation-of-a-first-model-using-the-lm-function" class="level3">
<h3 class="anchored" data-anchor-id="creation-of-a-first-model-using-the-lm-function">Creation of a first model using the ‘lm()’ function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Ascites <span class="sc">~</span> <span class="st">`</span><span class="at">Mortality (1 = y/0 = n)</span><span class="st">`</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ascites ~ `Mortality (1 = y/0 = n)`, data = df)

Coefficients:
              (Intercept)  `Mortality (1 = y/0 = n)`  
                   0.2811                    -0.0443  </code></pre>
</div>
</div>
<p>calculation of the mean values of the presence of the liver disease “Ascites” stratified on Mortality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Mortality (1 = y/0 = n)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Ascites))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  `Mortality (1 = y/0 = n)`  mean
                      &lt;dbl&gt; &lt;dbl&gt;
1                         0 0.281
2                         1 0.237</code></pre>
</div>
</div>
</section>
<section id="summary-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-the-model">Summary of the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ascites ~ `Mortality (1 = y/0 = n)`, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.2811 -0.2811 -0.2811  0.7189  0.7632 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                0.28114    0.01507  18.658   &lt;2e-16 ***
`Mortality (1 = y/0 = n)` -0.04430    0.03567  -1.242    0.215    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4457 on 1063 degrees of freedom
Multiple R-squared:  0.001449,  Adjusted R-squared:  0.0005092 
F-statistic: 1.542 on 1 and 1063 DF,  p-value: 0.2146</code></pre>
</div>
</div>
<p>by looking at the p-value, we can see if the variable “Ascites” is statistically significant or not. p-value &lt; 0.05 so the variable is statistically significant.</p>
<p>Pivoting the data to get a long dataset, so that all the liver diseases are defined in one column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Hepatic encephalopathy</span><span class="st">`</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>             SBP,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>             Ascites,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">Other fluid overload</span><span class="st">`</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>             AKI,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">UGIB due to portal hypertension</span><span class="st">`</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">HCC or cholangioca.</span><span class="st">`</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">Alcoholic hepatitis</span><span class="st">`</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">Jaundice- as isolated presentation</span><span class="st">`</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">Hepato-hydrothorax</span><span class="st">`</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>             ),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Liver diseases"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Presence"</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>df_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,650 × 11
      Id Sex    Age         CPS Charlson_CI Comorbidities Etiologies  Mortality
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;    
 1     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 2     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 3     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 4     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 5     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 6     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 7     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 8     1 Female [90; 100]     9           0 None          Cryptogenic No death 
 9     1 Female [90; 100]     9           0 None          Cryptogenic No death 
10     1 Female [90; 100]     9           0 None          Cryptogenic No death 
# ℹ 10,640 more rows
# ℹ 3 more variables: `Mortality (1 = y/0 = n)` &lt;dbl&gt;, `Liver diseases` &lt;chr&gt;,
#   Presence &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="addition-of-a-new-variable-model_object" class="level3">
<h3 class="anchored" data-anchor-id="addition-of-a-new-variable-model_object">Addition of a new variable model_object</h3>
<p>This variable will be computed per Liver disease and will contain the result to the call to the ‘map()’ function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_long_nested <span class="ot">&lt;-</span> df_long <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>df_long_nested <span class="sc">|&gt;</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_object =</span> <span class="fu">map</span>(<span class="at">.x =</span> data,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.f =</span> <span class="sc">~</span><span class="fu">lm</span>(<span class="at">formula =</span> Presence <span class="sc">~</span> <span class="st">`</span><span class="at">Mortality (1 = y/0 = n)</span><span class="st">`</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> .x))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Ascites"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(model_object)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]

Call:
lm(formula = Presence ~ `Mortality (1 = y/0 = n)`, data = .x)

Coefficients:
              (Intercept)  `Mortality (1 = y/0 = n)`  
                   0.2811                    -0.0443  </code></pre>
</div>
</div>
</section>
<section id="use-of-the-broom-package-to-tidy-the-fitted-model" class="level3">
<h3 class="anchored" data-anchor-id="use-of-the-broom-package-to-tidy-the-fitted-model">Use of the broom-package to tidy the fitted model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_long_nested <span class="ot">&lt;-</span> df_long_nested<span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_object =</span> <span class="fu">map</span>(<span class="at">.x =</span> data,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.f =</span> <span class="sc">~</span><span class="fu">lm</span>(<span class="at">formula =</span> Presence <span class="sc">~</span> <span class="st">`</span><span class="at">Mortality (1 = y/0 = n)</span><span class="st">`</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data =</span> .x))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>df_long_nested <span class="sc">|&gt;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(model_object) <span class="sc">|&gt;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term                  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)             0.213     0.0142     15.0  2.75e-46   0.185      0.240
2 `Mortality (1 = y/0 …   0.0927    0.0335      2.76 5.83e- 3   0.0269     0.159</code></pre>
</div>
</div>
<p>To apply the ‘tidy()’ function per model_object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_long_nested <span class="ot">&lt;-</span> df_long_nested <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_object_tidy =</span> <span class="fu">map</span>(<span class="at">.x =</span> model_object,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">.f =</span> <span class="sc">~</span><span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">x =</span> .x)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>df_long_nested</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   Liver diseases [10]
   `Liver diseases`                   data     model_object model_object_tidy
   &lt;chr&gt;                              &lt;list&gt;   &lt;list&gt;       &lt;list&gt;           
 1 Hepatic encephalopathy             &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 2 SBP                                &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 3 Ascites                            &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 4 Other fluid overload               &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 5 AKI                                &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 6 UGIB due to portal hypertension    &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 7 HCC or cholangioca.                &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 8 Alcoholic hepatitis                &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
 9 Jaundice- as isolated presentation &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; 
10 Hepato-hydrothorax                 &lt;tibble&gt; &lt;lm&gt;         &lt;tibble [2 × 7]&gt; </code></pre>
</div>
</div>
<p>Use of the ‘unnest()’ function to unpack the model_object_tidy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> df_long_nested <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>( model_object_tidy)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 10
# Groups:   Liver diseases [10]
   `Liver diseases`     data     model_object term  estimate std.error statistic
   &lt;chr&gt;                &lt;list&gt;   &lt;list&gt;       &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Hepatic encephalopa… &lt;tibble&gt; &lt;lm&gt;         (Int…  0.213     0.0142     15.0  
 2 Hepatic encephalopa… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0927    0.0335      2.76 
 3 SBP                  &lt;tibble&gt; &lt;lm&gt;         (Int…  0.0571    0.00768     7.44 
 4 SBP                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0150    0.0182     -0.827
 5 Ascites              &lt;tibble&gt; &lt;lm&gt;         (Int…  0.281     0.0151     18.7  
 6 Ascites              &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0443    0.0357     -1.24 
 7 Other fluid overload &lt;tibble&gt; &lt;lm&gt;         (Int…  0.0720    0.00855     8.42 
 8 Other fluid overload &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0194    0.0202     -0.957
 9 AKI                  &lt;tibble&gt; &lt;lm&gt;         (Int…  0.0457    0.00695     6.58 
10 AKI                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.00887   0.0165     -0.539
11 UGIB due to portal … &lt;tibble&gt; &lt;lm&gt;         (Int…  0.184     0.0129     14.2  
12 UGIB due to portal … &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0366    0.0306     -1.20 
13 HCC or cholangioca.  &lt;tibble&gt; &lt;lm&gt;         (Int…  0.0549    0.00774     7.09 
14 HCC or cholangioca.  &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.00304   0.0183      0.166
15 Alcoholic hepatitis  &lt;tibble&gt; &lt;lm&gt;         (Int…  0.0766    0.00870     8.80 
16 Alcoholic hepatitis  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0292    0.0206     -1.42 
17 Jaundice- as isolat… &lt;tibble&gt; &lt;lm&gt;         (Int…  0.00914   0.00384     2.38 
18 Jaundice- as isolat… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0224    0.00910     2.47 
19 Hepato-hydrothorax   &lt;tibble&gt; &lt;lm&gt;         (Int…  0.00686   0.00383     1.79 
20 Hepato-hydrothorax   &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0352    0.00906     3.89 
# ℹ 3 more variables: p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Un-grouping the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> estimate<span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"`Mortality (1 = y/0 = n)`"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>(<span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 10
   `Liver diseases`     data     model_object term  estimate std.error statistic
   &lt;chr&gt;                &lt;list&gt;   &lt;list&gt;       &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Hepatic encephalopa… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0927    0.0335      2.76 
 2 SBP                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0150    0.0182     -0.827
 3 Ascites              &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0443    0.0357     -1.24 
 4 Other fluid overload &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0194    0.0202     -0.957
 5 AKI                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.00887   0.0165     -0.539
 6 UGIB due to portal … &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0366    0.0306     -1.20 
 7 HCC or cholangioca.  &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.00304   0.0183      0.166
 8 Alcoholic hepatitis  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0292    0.0206     -1.42 
 9 Jaundice- as isolat… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0224    0.00910     2.47 
10 Hepato-hydrothorax   &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0352    0.00906     3.89 
# ℹ 3 more variables: p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Adding the variable q-value and an indicator variable denoting if a given liver disease is significant or not:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> estimate <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">q.value =</span> <span class="fu">p.adjust</span>(p.value),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">is.significant =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>      p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"yes"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"no"</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 12
   `Liver diseases`     data     model_object term  estimate std.error statistic
   &lt;chr&gt;                &lt;list&gt;   &lt;list&gt;       &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Hepatic encephalopa… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0927    0.0335      2.76 
 2 SBP                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0150    0.0182     -0.827
 3 Ascites              &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0443    0.0357     -1.24 
 4 Other fluid overload &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0194    0.0202     -0.957
 5 AKI                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.00887   0.0165     -0.539
 6 UGIB due to portal … &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0366    0.0306     -1.20 
 7 HCC or cholangioca.  &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.00304   0.0183      0.166
 8 Alcoholic hepatitis  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0292    0.0206     -1.42 
 9 Jaundice- as isolat… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0224    0.00910     2.47 
10 Hepato-hydrothorax   &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0352    0.00906     3.89 
# ℹ 5 more variables: p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;,
#   q.value &lt;dbl&gt;, is.significant &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"forcats"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"forcats"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 12
   `Liver diseases`     data     model_object term  estimate std.error statistic
   &lt;chr&gt;                &lt;list&gt;   &lt;list&gt;       &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Hepatic encephalopa… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0927    0.0335      2.76 
 2 SBP                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0150    0.0182     -0.827
 3 Ascites              &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0443    0.0357     -1.24 
 4 Other fluid overload &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0194    0.0202     -0.957
 5 AKI                  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.00887   0.0165     -0.539
 6 UGIB due to portal … &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0366    0.0306     -1.20 
 7 HCC or cholangioca.  &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.00304   0.0183      0.166
 8 Alcoholic hepatitis  &lt;tibble&gt; &lt;lm&gt;         `Mor… -0.0292    0.0206     -1.42 
 9 Jaundice- as isolat… &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0224    0.00910     2.47 
10 Hepato-hydrothorax   &lt;tibble&gt; &lt;lm&gt;         `Mor…  0.0352    0.00906     3.89 
# ℹ 5 more variables: p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;,
#   q.value &lt;dbl&gt;, is.significant &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Estimates_LV_Mortality <span class="ot">&lt;-</span> estimate <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> estimate,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> conf.low,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xmax =</span> conf.high,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="fu">fct_reorder</span>(<span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>,estimate))) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Liver diseases associated with mortality "</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Estimates(95% CIs)"</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">12.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Estimates_LV_Mortality.png"</span>, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> <span class="st">"../results/plots/"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> Estimates_LV_Mortality,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Significance_plot_LV_mortality <span class="ot">&lt;-</span> estimate <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(q.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> estimate,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> estimate, </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="sc">-</span> <span class="fu">log10</span>(p.value), </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> is.significant, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(<span class="sc">-</span> <span class="fu">log10</span>(p.value) <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">`</span><span class="at">Liver diseases</span><span class="st">`</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">""</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                  ) </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Liver diseases associated with mortality"</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Estimates(95% CIs)"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">0.12</span>))</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>Significance_plot_LV_mortality</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08_analysis_liver_disease_files/figure-html/unnamed-chunk-16-1.svg" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Significance_plot_LV_mortality.png"</span>, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> <span class="st">"../results/plots/"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> Significance_plot_LV_mortality,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>According to these two plots, three of the observed liver diseases have are significantly associated with mortality. These diseases are Hepato-hydrothorax, hepatic encephalopathy and jaundice as isolated presentation. They all have a positive association with mortality, which means that the patients with these liver diseases are more likely to die of cirrhosis than the patients with other liver diseases. These results are coherent with the plot of the “liver disease repartition in cyrrhosis patients, stratified by mortality” present in the file ‘05_analysis_ mortality.qmd’.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>